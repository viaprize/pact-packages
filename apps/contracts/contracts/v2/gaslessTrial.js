import {
  PaymasterMode,
  createPaymaster,
  createSmartAccountClient,
} from "@biconomy/account";
import { createBundler } from "@biconomy/bundler";
import { createWalletClient, encodeFunctionData, http } from "viem";
import { privateKeyToAccount } from "viem/accounts";
import { optimismSepolia } from "viem/chains";

// import abi from "./abi.json" assert { type: "json" };

const trx = async () => {
  const config = {
    privateKey:
      "9e2cd1b489890a7476c20ead1c8c195d93c9544bc88d5c712f7c7233b76b97ac",
    biconomyPaymasterApiKey: "TZG4TFMtL.6d3bcbd7-42e3-4464-9d85-a25cd0e0a56a",
    bundlerUrl:
      "https://bundler.biconomy.io/api/v2/11155420/nJPK7B3ru.dd7f7861-190d-41bd-af80-6877f74b8f44", // <-- Read about this at https://docs.biconomy.io/dashboard#bundler-url
  };
  const paymaster = await createPaymaster({
    paymasterUrl:
      "https://paymaster.biconomy.io/api/v1/11155420/TZG4TFMtL.6d3bcbd7-42e3-4464-9d85-a25cd0e0a56a", // <-- Read about at https://docs.biconomy.io/dashboard/paymaster
    strictMode: true,
  });

  const bundler = await createBundler({
    bundlerUrl:
      "https://bundler.biconomy.io/api/v2/11155420/nJPK7B3ru.dd7f7861-190d-41bd-af80-6877f74b8f44", // <-- Read about this at https://docs.biconomy.io/dashboard#bundler-url
  });

  const account = privateKeyToAccount(`0x` + config.privateKey);
  const client = createWalletClient({
    account,
    chain: optimismSepolia,
    transport: http(),
  });

  // Create Biconomy Smart Account instance
  const smartWallet = await createSmartAccountClient({
    signer: client,
    chainId: 11155420,
    paymaster,
    bundler,
  });

  const saAddress = await smartWallet.getAccountAddress();
  console.log("SA Address", saAddress);
  // console.log("smart wallet", smartWallet);

  const abi = [
    {
      inputs: [
        {
          internalType: "uint256",
          name: "_amountUsdc",
          type: "uint256",
        },
      ],
      name: "addBridgedUSDCFunds",
      outputs: [],
      stateMutability: "nonpayable",
      type: "function",
    },
    {
      inputs: [],
      name: "addEthFunds",
      outputs: [],
      stateMutability: "payable",
      type: "function",
    },
    {
      inputs: [
        {
          internalType: "address",
          name: "_sender",
          type: "address",
        },
        {
          internalType: "uint256",
          name: "_amountUsdc",
          type: "uint256",
        },
        {
          internalType: "uint256",
          name: "_deadline",
          type: "uint256",
        },
        {
          internalType: "uint8",
          name: "v",
          type: "uint8",
        },
        {
          internalType: "bytes32",
          name: "r",
          type: "bytes32",
        },
        {
          internalType: "bytes32",
          name: "s",
          type: "bytes32",
        },
      ],
      name: "addUSDCFunds",
      outputs: [],
      stateMutability: "nonpayable",
      type: "function",
    },
    {
      inputs: [],
      name: "endCampaign",
      outputs: [],
      stateMutability: "nonpayable",
      type: "function",
    },
    {
      inputs: [
        {
          internalType: "address",
          name: "_proposer",
          type: "address",
        },
        {
          internalType: "address[]",
          name: "_platformAdmins",
          type: "address[]",
        },
        {
          internalType: "address",
          name: "_token",
          type: "address",
        },
        {
          internalType: "address",
          name: "_bridgedToken",
          type: "address",
        },
        {
          internalType: "address",
          name: "_wethCoin",
          type: "address",
        },
        {
          internalType: "uint256",
          name: "_platformFee",
          type: "uint256",
        },
      ],
      stateMutability: "nonpayable",
      type: "constructor",
    },
    {
      inputs: [],
      name: "FundingToContractEnded",
      type: "error",
    },
    {
      inputs: [],
      name: "NotEnoughFunds",
      type: "error",
    },
    {
      anonymous: false,
      inputs: [
        {
          indexed: false,
          internalType: "address",
          name: "receipent",
          type: "address",
        },
        {
          indexed: false,
          internalType: "uint256",
          name: "totalFunds",
          type: "uint256",
        },
        {
          indexed: false,
          internalType: "uint256",
          name: "totalRewards",
          type: "uint256",
        },
      ],
      name: "Values",
      type: "event",
    },
    {
      inputs: [
        {
          internalType: "address",
          name: "_admin",
          type: "address",
        },
      ],
      name: "voteToRevokePlatformAdmin",
      outputs: [],
      stateMutability: "nonpayable",
      type: "function",
    },
    {
      stateMutability: "payable",
      type: "receive",
    },
    {
      inputs: [
        {
          internalType: "address",
          name: "",
          type: "address",
        },
      ],
      name: "funderAmount",
      outputs: [
        {
          internalType: "uint256",
          name: "",
          type: "uint256",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
    {
      inputs: [
        {
          internalType: "uint256",
          name: "",
          type: "uint256",
        },
      ],
      name: "funders",
      outputs: [
        {
          internalType: "address",
          name: "",
          type: "address",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
    {
      inputs: [],
      name: "isActive",
      outputs: [
        {
          internalType: "bool",
          name: "",
          type: "bool",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
    {
      inputs: [
        {
          internalType: "address",
          name: "",
          type: "address",
        },
      ],
      name: "isFunder",
      outputs: [
        {
          internalType: "bool",
          name: "",
          type: "bool",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
    {
      inputs: [
        {
          internalType: "address",
          name: "",
          type: "address",
        },
      ],
      name: "isplatformAdmin",
      outputs: [
        {
          internalType: "bool",
          name: "",
          type: "bool",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
    {
      inputs: [
        {
          internalType: "address",
          name: "",
          type: "address",
        },
      ],
      name: "isProposer",
      outputs: [
        {
          internalType: "bool",
          name: "",
          type: "bool",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
    {
      inputs: [],
      name: "platformAddress",
      outputs: [
        {
          internalType: "address",
          name: "",
          type: "address",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
    {
      inputs: [
        {
          internalType: "uint256",
          name: "",
          type: "uint256",
        },
      ],
      name: "platformAdmins",
      outputs: [
        {
          internalType: "address",
          name: "",
          type: "address",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
    {
      inputs: [],
      name: "platformFee",
      outputs: [
        {
          internalType: "uint256",
          name: "",
          type: "uint256",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
    {
      inputs: [],
      name: "proposer",
      outputs: [
        {
          internalType: "address",
          name: "",
          type: "address",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
    {
      inputs: [],
      name: "receipent",
      outputs: [
        {
          internalType: "address",
          name: "",
          type: "address",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
    {
      inputs: [],
      name: "retrieveAllFunders",
      outputs: [
        {
          internalType: "address[]",
          name: "",
          type: "address[]",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
    {
      inputs: [
        {
          internalType: "address",
          name: "",
          type: "address",
        },
      ],
      name: "revokeVotes",
      outputs: [
        {
          internalType: "uint256",
          name: "",
          type: "uint256",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
    {
      inputs: [],
      name: "swap2Router",
      outputs: [
        {
          internalType: "contract IUniswapV2Router02",
          name: "",
          type: "address",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
    {
      inputs: [],
      name: "swapRouter",
      outputs: [
        {
          internalType: "contract ISwapRouter",
          name: "",
          type: "address",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
    {
      inputs: [],
      name: "totalFunds",
      outputs: [
        {
          internalType: "uint256",
          name: "",
          type: "uint256",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
    {
      inputs: [],
      name: "totalPlatformAdmins",
      outputs: [
        {
          internalType: "uint256",
          name: "",
          type: "uint256",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
    {
      inputs: [],
      name: "totalRewards",
      outputs: [
        {
          internalType: "uint256",
          name: "",
          type: "uint256",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
    {
      inputs: [],
      name: "USDC",
      outputs: [
        {
          internalType: "address",
          name: "",
          type: "address",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
    {
      inputs: [],
      name: "USDC_E",
      outputs: [
        {
          internalType: "address",
          name: "",
          type: "address",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
    {
      inputs: [],
      name: "WETH",
      outputs: [
        {
          internalType: "address",
          name: "",
          type: "address",
        },
      ],
      stateMutability: "view",
      type: "function",
    },
  ];
  try {
    // const constructorArguments = [
    //     "0x18E1f76217D05F1FfBC3129a035ca29304706774",
    //     ["0x18E1f76217D05F1FfBC3129a035ca29304706774"],
    //     "0x18E1f76217D05F1FfBC3129a035ca29304706774",
    //     "0x18E1f76217D05F1FfBC3129a035ca29304706774",
    //     "0x18E1f76217D05F1FfBC3129a035ca29304706774",
    //   5
    // ]
    // console.log(constructorArguments)
    // const functionData = encodeDeployData({
    //   abi: abi,
    //   bytecode: '0x608060405260043610610184575f3560e01c806378cabe20116100d0578063a8e4fb9011610089578063c31c9c0711610063578063c31c9c0714610567578063dbe55e5614610591578063dc0d3dff146105bb578063fce1b2ba146105f757610193565b8063a8e4fb90146104d7578063ad5c464814610501578063af5e73a41461052b57610193565b806378cabe20146103cb5780637ec4df35146103f557806380d13af51461041f57806389a302711461045b578063968ed600146104855780639b1ded12146104af57610193565b806334fe77d91161013d57806347c49fda1161011757806347c49fda1461034557806356fa819e1461034f57806371aac7f91461037957806374ec29a01461038f57610193565b806334fe77d9146102a357806336e6d99e146102df5780633db1912c1461031b57610193565b80630d2c5441146101975780630e15561a146101c15780631ea48870146101eb57806322f3e2d41461022757806326232a2e146102515780632f225fe11461027b57610193565b366101935761019161061f565b005b5f80fd5b3480156101a2575f80fd5b506101ab610cd6565b6040516101b891906122a7565b60405180910390f35b3480156101cc575f80fd5b506101d5610cfb565b6040516101e291906122d8565b60405180910390f35b3480156101f6575f80fd5b50610211600480360381019061020c919061231f565b610d01565b60405161021e9190612364565b60405180910390f35b348015610232575f80fd5b5061023b610d1e565b6040516102489190612364565b60405180910390f35b34801561025c575f80fd5b50610265610d30565b60405161027291906122d8565b60405180910390f35b348015610286575f80fd5b506102a1600480360381019061029c91906123a7565b610d36565b005b3480156102ae575f80fd5b506102c960048036038101906102c4919061231f565b6114bc565b6040516102d69190612364565b60405180910390f35b3480156102ea575f80fd5b50610305600480360381019061030091906123a7565b6114d9565b60405161031291906122a7565b60405180910390f35b348015610326575f80fd5b5061032f611514565b60405161033c91906122a7565b60405180910390f35b61034d61061f565b005b34801561035a575f80fd5b50610363611539565b60405161037091906122d8565b60405180910390f35b348015610384575f80fd5b5061038d61153f565b005b34801561039a575f80fd5b506103b560048036038101906103b0919061231f565b611690565b6040516103c29190612364565b60405180910390f35b3480156103d6575f80fd5b506103df6116ad565b6040516103ec919061242d565b60405180910390f35b348015610400575f80fd5b506104096116d1565b60405161041691906124fd565b60405180910390f35b34801561042a575f80fd5b506104456004803603810190610440919061231f565b61175c565b60405161045291906122d8565b60405180910390f35b348015610466575f80fd5b5061046f611771565b60405161047c91906122a7565b60405180910390f35b348015610490575f80fd5b50610499611796565b6040516104a691906122d8565b60405180910390f35b3480156104ba575f80fd5b506104d560048036038101906104d09190612586565b61179c565b005b3480156104e2575f80fd5b506104eb611ccc565b6040516104f891906122a7565b60405180910390f35b34801561050c575f80fd5b50610515611cef565b60405161052291906122a7565b60405180910390f35b348015610536575f80fd5b50610551600480360381019061054c919061231f565b611d14565b60405161055e91906122d8565b60405180910390f35b348015610572575f80fd5b5061057b611d29565b604051610588919061262f565b60405180910390f35b34801561059c575f80fd5b506105a5611d4d565b6040516105b291906122a7565b60405180910390f35b3480156105c6575f80fd5b506105e160048036038101906105dc91906123a7565b611d72565b6040516105ee91906122a7565b60405180910390f35b348015610602575f80fd5b5061061d6004803603810190610618919061231f565b611dad565b005b600c60019054906101000a900460ff161561066f576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610666906126a2565b60405180910390fd5b6001600c60016101000a81548160ff0219169083151502179055505f34036106c3576040517f81b5ad6800000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b600c5f9054906101000a900460ff16610708576040517f6cb50c7f00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b5f349050600e5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663d0e30db0346040518263ffffffff1660e01b81526004015f604051808303818588803b158015610773575f80fd5b505af1158015610785573d5f803e3d5ffd5b5050505050600e5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663095ea7b37f000000000000000000000000e592427a0aece92de3edee1f18e0157c05861564836040518363ffffffff1660e01b81526004016108069291906126c0565b6020604051808303815f875af1158015610822573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906108469190612711565b505f60405180610100016040528060115f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001600f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001610bb862ffffff1681526020013073ffffffffffffffffffffffffffffffffffffffff1681526020014281526020018381526020015f81526020015f73ffffffffffffffffffffffffffffffffffffffff1681525090505f7f000000000000000000000000e592427a0aece92de3edee1f18e0157c0586156473ffffffffffffffffffffffffffffffffffffffff1663414bf389836040518263ffffffff1660e01b815260040161097f9190612817565b6020604051808303815f875af115801561099b573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906109bf9190612845565b9050600733908060018154018082558091505060019003905f5260205f20015f9091909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600160085f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f6101000a81548160ff021916908315150217905550610a8b81600a54611ef590919063ffffffff16565b600a81905550610ad9610ac86064610aba6006546064610aab919061289d565b85611f1b90919063ffffffff16565b611f5b90919063ffffffff16565b600b54611ef590919063ffffffff16565b600b81905550600c60029054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb60045f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16610b736064610b656006546064610b56919061289d565b87611f1b90919063ffffffff16565b611f5b90919063ffffffff16565b6040518363ffffffff1660e01b8152600401610b909291906126c0565b6020604051808303815f875af1158015610bac573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610bd09190612711565b50600c60029054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb60055f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16610c596064610c4b60065487611f1b90919063ffffffff16565b611f5b90919063ffffffff16565b6040518363ffffffff1660e01b8152600401610c769291906126c0565b6020604051808303815f875af1158015610c92573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610cb69190612711565b505050505f600c60016101000a81548160ff021916908315150217905550565b60105f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600b5481565b6008602052805f5260405f205f915054906101000a900460ff1681565b600c5f9054906101000a900460ff1681565b60065481565b600c60019054906101000a900460ff1615610d86576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610d7d906126a2565b60405180910390fd5b6001600c60016101000a81548160ff0219169083151502179055505f8111610de3576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610dda9061291a565b60405180910390fd5b80600d5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663dd62ed3e33306040518363ffffffff1660e01b8152600401610e40929190612938565b602060405180830381865afa158015610e5b573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610e7f9190612845565b1015610ec0576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610eb7906129a9565b60405180910390fd5b600c5f9054906101000a900460ff16610f05576040517f6cb50c7f00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b610f3260105f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16333084611f70565b610f7e60105f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff167f000000000000000000000000e592427a0aece92de3edee1f18e0157c05861564836120c2565b5f732ab22ac86b25bd448a4d9dc041bd2384655299c490505f6040518060a0016040528060105f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff1663ddca3f436040518163ffffffff1660e01b8152600401602060405180830381865afa15801561100d573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061103191906129f1565b600f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1660405160200161106593929190612a95565b60405160208183030381529060405281526020013073ffffffffffffffffffffffffffffffffffffffff168152602001428152602001848152602001627a120081525090505f7f000000000000000000000000e592427a0aece92de3edee1f18e0157c0586156473ffffffffffffffffffffffffffffffffffffffff1663c04b8d59836040518263ffffffff1660e01b81526004016111049190612bb4565b6020604051808303815f875af1158015611120573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906111449190612845565b9050600733908060018154018082558091505060019003905f5260205f20015f9091909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600160085f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f6101000a81548160ff02191690831515021790555061121081600a54611ef590919063ffffffff16565b600a8190555061125e61124d606461123f6006546064611230919061289d565b85611f1b90919063ffffffff16565b611f5b90919063ffffffff16565b600b54611ef590919063ffffffff16565b600b81905550600c60029054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb60045f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff166112f860646112ea60065460646112db919061289d565b87611f1b90919063ffffffff16565b611f5b90919063ffffffff16565b6040518363ffffffff1660e01b81526004016113159291906126c0565b6020604051808303815f875af1158015611331573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906113559190612711565b50600c60029054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb60055f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff166113de60646113d060065487611f1b90919063ffffffff16565b611f5b90919063ffffffff16565b6040518363ffffffff1660e01b81526004016113fb9291906126c0565b6020604051808303815f875af1158015611417573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061143b9190612711565b507fa9b219ab8bf3e7a550b1c64e7e1761976044f72213b06104705414fb3b70062560045f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600a54600b5460405161149493929190612bd4565b60405180910390a15050505f600c60016101000a81548160ff02191690831515021790555050565b6003602052805f5260405f205f915054906101000a900460ff1681565b600281815481106114e8575f80fd5b905f5260205f20015f915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60045f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60135481565b6001151560015f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff16151514806115e857506001151560035f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff161515145b611627576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161161e90612c79565b60405180910390fd5b600c5f9054906101000a900460ff16611675576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161166c90612d07565b60405180910390fd5b5f600c5f6101000a81548160ff021916908315150217905550565b6001602052805f5260405f205f915054906101000a900460ff1681565b7f00000000000000000000000068b3465833fb72a70ecdf485e0e4c7bd8665fc4581565b6060600780548060200260200160405190810160405280929190818152602001828054801561175257602002820191905f5260205f20905b815f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019060010190808311611709575b5050505050905090565b6012602052805f5260405f205f915090505481565b600f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600a5481565b600c60019054906101000a900460ff16156117ec576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016117e3906126a2565b60405180910390fd5b6001600c60016101000a81548160ff0219169083151502179055505f8511611849576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016118409061291a565b60405180910390fd5b600c5f9054906101000a900460ff1661188e576040517f6cb50c7f00000000000000000000000000000000000000000000000000000000815260040160405180910390fd5b600c60029054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663d505accf873088888888886040518863ffffffff1660e01b81526004016118f59796959493929190612d43565b5f604051808303815f87803b15801561190c575f80fd5b505af115801561191e573d5f803e3d5ffd5b5050505061194f600f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16333088611f70565b5f859050600733908060018154018082558091505060019003905f5260205f20015f9091909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600160085f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f6101000a81548160ff021916908315150217905550611a1d81600a54611ef590919063ffffffff16565b600a81905550611a6b611a5a6064611a4c6006546064611a3d919061289d565b85611f1b90919063ffffffff16565b611f5b90919063ffffffff16565b600b54611ef590919063ffffffff16565b600b81905550600c60029054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb60045f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16611b056064611af76006546064611ae8919061289d565b87611f1b90919063ffffffff16565b611f5b90919063ffffffff16565b6040518363ffffffff1660e01b8152600401611b229291906126c0565b6020604051808303815f875af1158015611b3e573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190611b629190612711565b50600c60029054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb60055f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16611beb6064611bdd60065487611f1b90919063ffffffff16565b611f5b90919063ffffffff16565b6040518363ffffffff1660e01b8152600401611c089291906126c0565b6020604051808303815f875af1158015611c24573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190611c489190612711565b507fa9b219ab8bf3e7a550b1c64e7e1761976044f72213b06104705414fb3b70062560045f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600a54600b54604051611ca193929190612bd4565b60405180910390a1505f600c60016101000a81548160ff021916908315150217905550505050505050565b5f8054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60115f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6009602052805f5260405f205f915090505481565b7f000000000000000000000000e592427a0aece92de3edee1f18e0157c0586156481565b60055f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60078181548110611d81575f80fd5b905f5260205f20015f915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60035f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f9054906101000a900460ff16611e36576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611e2d90612e20565b60405180910390fd5b600160125f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f828254611e839190612e3e565b9250508190555060036013546002611e9b9190612e71565b611ea59190612edf565b60125f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205410611ef257611ef181612211565b5b50565b5f8183611f029190612e3e565b905082811015611f1557611f14612f0f565b5b92915050565b5f808303611f2b575f9050611f55565b8183611f379190612e71565b9050818382611f469190612edf565b14611f5457611f53612f0f565b5b5b92915050565b5f8183611f689190612edf565b905092915050565b5f808573ffffffffffffffffffffffffffffffffffffffff166323b872dd60e01b868686604051602401611fa693929190612f3c565b604051602081830303815290604052907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19166020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff83818316178352505050506040516120109190612fab565b5f604051808303815f865af19150503d805f8114612049576040519150601f19603f3d011682016040523d82523d5f602084013e61204e565b606091505b509150915081801561207b57505f8151148061207a5750808060200190518101906120799190612711565b5b5b6120ba576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016120b19061300b565b60405180910390fd5b505050505050565b5f808473ffffffffffffffffffffffffffffffffffffffff1663095ea7b360e01b85856040516024016120f69291906126c0565b604051602081830303815290604052907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19166020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff83818316178352505050506040516121609190612fab565b5f604051808303815f865af19150503d805f8114612199576040519150601f19603f3d011682016040523d82523d5f602084013e61219e565b606091505b50915091508180156121cb57505f815114806121ca5750808060200190518101906121c99190612711565b5b5b61220a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161220190613073565b60405180910390fd5b5050505050565b5f60035f8373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f6101000a81548160ff02191690831515021790555050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61229182612268565b9050919050565b6122a181612287565b82525050565b5f6020820190506122ba5f830184612298565b92915050565b5f819050919050565b6122d2816122c0565b82525050565b5f6020820190506122eb5f8301846122c9565b92915050565b5f80fd5b6122fe81612287565b8114612308575f80fd5b50565b5f81359050612319816122f5565b92915050565b5f60208284031215612334576123336122f1565b5b5f6123418482850161230b565b91505092915050565b5f8115159050919050565b61235e8161234a565b82525050565b5f6020820190506123775f830184612355565b92915050565b612386816122c0565b8114612390575f80fd5b50565b5f813590506123a18161237d565b92915050565b5f602082840312156123bc576123bb6122f1565b5b5f6123c984828501612393565b91505092915050565b5f819050919050565b5f6123f56123f06123eb84612268565b6123d2565b612268565b9050919050565b5f612406826123db565b9050919050565b5f612417826123fc565b9050919050565b6124278161240d565b82525050565b5f6020820190506124405f83018461241e565b92915050565b5f81519050919050565b5f82825260208201905092915050565b5f819050602082019050919050565b61247881612287565b82525050565b5f612489838361246f565b60208301905092915050565b5f602082019050919050565b5f6124ab82612446565b6124b58185612450565b93506124c083612460565b805f5b838110156124f05781516124d7888261247e565b97506124e283612495565b9250506001810190506124c3565b5085935050505092915050565b5f6020820190508181035f83015261251581846124a1565b905092915050565b5f60ff82169050919050565b6125328161251d565b811461253c575f80fd5b50565b5f8135905061254d81612529565b92915050565b5f819050919050565b61256581612553565b811461256f575f80fd5b50565b5f813590506125808161255c565b92915050565b5f805f805f8060c087890312156125a05761259f6122f1565b5b5f6125ad89828a0161230b565b96505060206125be89828a01612393565b95505060406125cf89828a01612393565b94505060606125e089828a0161253f565b93505060806125f189828a01612572565b92505060a061260289828a01612572565b9150509295509295509295565b5f612619826123fc565b9050919050565b6126298161260f565b82525050565b5f6020820190506126425f830184612620565b92915050565b5f82825260208201905092915050565b7f4e6f2063686561742c204e6f2052652d656e7472616e637900000000000000005f82015250565b5f61268c601883612648565b915061269782612658565b602082019050919050565b5f6020820190508181035f8301526126b981612680565b9050919050565b5f6040820190506126d35f830185612298565b6126e060208301846122c9565b9392505050565b6126f08161234a565b81146126fa575f80fd5b50565b5f8151905061270b816126e7565b92915050565b5f60208284031215612726576127256122f1565b5b5f612733848285016126fd565b91505092915050565b5f62ffffff82169050919050565b6127538161273c565b82525050565b612762816122c0565b82525050565b61277181612268565b82525050565b61010082015f82015161278c5f85018261246f565b50602082015161279f602085018261246f565b5060408201516127b2604085018261274a565b5060608201516127c5606085018261246f565b5060808201516127d86080850182612759565b5060a08201516127eb60a0850182612759565b5060c08201516127fe60c0850182612759565b5060e082015161281160e0850182612768565b50505050565b5f6101008201905061282b5f830184612777565b92915050565b5f8151905061283f8161237d565b92915050565b5f6020828403121561285a576128596122f1565b5b5f61286784828501612831565b91505092915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f6128a7826122c0565b91506128b2836122c0565b92508282039050818111156128ca576128c9612870565b5b92915050565b7f66756e64732073686f756c642062652067726561746572207468616e203000005f82015250565b5f612904601e83612648565b915061290f826128d0565b602082019050919050565b5f6020820190508181035f830152612931816128f8565b9050919050565b5f60408201905061294b5f830185612298565b6129586020830184612298565b9392505050565b7f4e6f7420656e6f756768205553444320617070726f76656400000000000000005f82015250565b5f612993601883612648565b915061299e8261295f565b602082019050919050565b5f6020820190508181035f8301526129c081612987565b9050919050565b6129d08161273c565b81146129da575f80fd5b50565b5f815190506129eb816129c7565b92915050565b5f60208284031215612a0657612a056122f1565b5b5f612a13848285016129dd565b91505092915050565b5f8160601b9050919050565b5f612a3282612a1c565b9050919050565b5f612a4382612a28565b9050919050565b612a5b612a5682612287565b612a39565b82525050565b5f8160e81b9050919050565b5f612a7782612a61565b9050919050565b612a8f612a8a8261273c565b612a6d565b82525050565b5f612aa08286612a4a565b601482019150612ab08285612a7e565b600382019150612ac08284612a4a565b601482019150819050949350505050565b5f81519050919050565b5f82825260208201905092915050565b8281835e5f83830152505050565b5f601f19601f8301169050919050565b5f612b1382612ad1565b612b1d8185612adb565b9350612b2d818560208601612aeb565b612b3681612af9565b840191505092915050565b5f60a083015f8301518482035f860152612b5b8282612b09565b9150506020830151612b70602086018261246f565b506040830151612b836040860182612759565b506060830151612b966060860182612759565b506080830151612ba96080860182612759565b508091505092915050565b5f6020820190508181035f830152612bcc8184612b41565b905092915050565b5f606082019050612be75f830186612298565b612bf460208301856122c9565b612c0160408301846122c9565b949350505050565b7f596f7520617265206e6f7420612070726f706f736572206f7220706c6174666f5f8201527f726d41646d696e2e000000000000000000000000000000000000000000000000602082015250565b5f612c63602883612648565b9150612c6e82612c09565b604082019050919050565b5f6020820190508181035f830152612c9081612c57565b9050919050565b7f63616d706169676e206973206e6f7420616374697665206f7220616c726561645f8201527f7920656e64656400000000000000000000000000000000000000000000000000602082015250565b5f612cf1602783612648565b9150612cfc82612c97565b604082019050919050565b5f6020820190508181035f830152612d1e81612ce5565b9050919050565b612d2e8161251d565b82525050565b612d3d81612553565b82525050565b5f60e082019050612d565f83018a612298565b612d636020830189612298565b612d7060408301886122c9565b612d7d60608301876122c9565b612d8a6080830186612d25565b612d9760a0830185612d34565b612da460c0830184612d34565b98975050505050505050565b7f796f7520617265206e6f7420616e20706c6174666f726d2061646d696e20746f5f8201527f20766f746520666f72207265766f6b6500000000000000000000000000000000602082015250565b5f612e0a603083612648565b9150612e1582612db0565b604082019050919050565b5f6020820190508181035f830152612e3781612dfe565b9050919050565b5f612e48826122c0565b9150612e53836122c0565b9250828201905080821115612e6b57612e6a612870565b5b92915050565b5f612e7b826122c0565b9150612e86836122c0565b9250828202612e94816122c0565b91508282048414831517612eab57612eaa612870565b5b5092915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601260045260245ffd5b5f612ee9826122c0565b9150612ef4836122c0565b925082612f0457612f03612eb2565b5b828204905092915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52600160045260245ffd5b5f606082019050612f4f5f830186612298565b612f5c6020830185612298565b612f6960408301846122c9565b949350505050565b5f81905092915050565b5f612f8582612ad1565b612f8f8185612f71565b9350612f9f818560208601612aeb565b80840191505092915050565b5f612fb68284612f7b565b915081905092915050565b7f53544600000000000000000000000000000000000000000000000000000000005f82015250565b5f612ff5600383612648565b915061300082612fc1565b602082019050919050565b5f6020820190508181035f83015261302281612fe9565b9050919050565b7f53410000000000000000000000000000000000000000000000000000000000005f82015250565b5f61305d600283612648565b915061306882613029565b602082019050919050565b5f6020820190508181035f83015261308a81613051565b905091905056fea26469706673582212202e9e59c0f4c4a2971eedb7a959861326c5afa7009af3393af57a9ea7249eceb364736f6c63430008190033',
    //   args: constructorArguments
    // })

    const functionData = encodeFunctionData({
      abi: abi,
      functionName: "voteToRevokePlatformAdmin",
      args: ["0x5923203a92ABa3Eb92940F42f6eB5267BA377D5f"],
    });
    console.log("functionData....", functionData);
    const tx = {
      to: "0x3da3822d8a03d811d391da01528441518e66f1b1",
      data: functionData,
    };
    // const userOp = await smartWallet.buildUserOp([tx]);
    // const {
    //     maxFeePerGas,
    //     maxPriorityFeePerGas,
    //     verificationGasLimit,
    //     callGasLimit,
    //     preVerificationGas,
    //   } = await bundler.estimateUserOpGas(userOp);

    console.log("transaction", tx);
    // const tx1 = getAddress(tx)
    console.log("smart wallet", smartWallet);
    // const feeQuotesResponse = await smartWallet.getTokenFees(tx, { paymasterServiceData: { mode: PaymasterMode.SPONSORED } });
    // console.log(feeQuotesResponse);
    // const userSeletedFeeQuote = feeQuotesResponse.feeQuotes?.[0];

    const userOpResponse = await smartWallet.sendTransaction(tx, {
      paymasterServiceData: { mode: PaymasterMode.SPONSORED },
      // feeQuote: userSeletedFeeQuote,
      // spender: feeQuotesResponse.tokenPaymasterAddress,
    });
    console.log("user op response", userOpResponse);
    const { transactionHash } = await userOpResponse.waitForTxHash();
    console.log("Transaction Hash", transactionHash);
    const userOpReceipt = await userOpResponse.wait();
    if (userOpReceipt.success == "true") {
      console.log("UserOp receipt", userOpReceipt);
      console.log("Transaction receipt", userOpReceipt.receipt);
    }
  } catch (error) {
    console.log("error........", error);
  }
};

trx();
